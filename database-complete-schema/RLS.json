[
  {
    "tablename": "bookings",
    "policyname": "Admin and staff can delete bookings",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "DELETE",
    "using_expression": "(is_admin() OR is_staff())",
    "check_expression": null
  },
  {
    "tablename": "bookings",
    "policyname": "Customers can create bookings",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "INSERT",
    "using_expression": null,
    "check_expression": "((auth.uid() = user_id) OR (user_id IS NULL))"
  },
  {
    "tablename": "bookings",
    "policyname": "Customers can update own bookings",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "UPDATE",
    "using_expression": "((auth.uid() = user_id) OR is_admin() OR is_staff())",
    "check_expression": null
  },
  {
    "tablename": "bookings",
    "policyname": "Customers can view own bookings",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "((auth.uid() = user_id) OR is_admin() OR is_staff())",
    "check_expression": null
  },
  {
    "tablename": "calendar_sync_logs",
    "policyname": "Admin can view sync logs",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "service_categories",
    "policyname": "Admins can manage service categories",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "ALL",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "service_categories",
    "policyname": "Public can view service categories",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "true",
    "check_expression": null
  },
  {
    "tablename": "services",
    "policyname": "Admins can delete services",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "DELETE",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "services",
    "policyname": "Admins can insert services",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "INSERT",
    "using_expression": null,
    "check_expression": "is_admin()"
  },
  {
    "tablename": "services",
    "policyname": "Admins can update services",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "UPDATE",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "services",
    "policyname": "Public can view active services",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "((is_active = true) OR is_admin() OR is_staff())",
    "check_expression": null
  },
  {
    "tablename": "staff",
    "policyname": "Admins can delete staff",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "DELETE",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "staff",
    "policyname": "Admins can insert staff",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "INSERT",
    "using_expression": null,
    "check_expression": "is_admin()"
  },
  {
    "tablename": "staff",
    "policyname": "Admins can update staff",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "UPDATE",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "staff",
    "policyname": "Public can view active staff",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "((is_active = true) OR is_admin() OR is_staff())",
    "check_expression": null
  },
  {
    "tablename": "staff_categories",
    "policyname": "Admins can manage staff categories",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "ALL",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "staff_categories",
    "policyname": "Public can view staff categories",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "true",
    "check_expression": null
  },
  {
    "tablename": "staff_schedules",
    "policyname": "Admins and staff can manage staff schedules",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "ALL",
    "using_expression": "(is_admin() OR is_staff())",
    "check_expression": null
  },
  {
    "tablename": "staff_schedules",
    "policyname": "Public can view staff schedules",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "true",
    "check_expression": null
  },
  {
    "tablename": "staff_services",
    "policyname": "Admins can manage staff services",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "ALL",
    "using_expression": "is_admin()",
    "check_expression": null
  },
  {
    "tablename": "staff_services",
    "policyname": "Public can view staff services",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "true",
    "check_expression": null
  },
  {
    "tablename": "user_profiles",
    "policyname": "Admins can read all profiles",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM user_profiles user_profiles_1\n  WHERE ((user_profiles_1.id = auth.uid()) AND (user_profiles_1.role = 'admin'::text))))",
    "check_expression": null
  },
  {
    "tablename": "user_profiles",
    "policyname": "Admins can update all profiles",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "UPDATE",
    "using_expression": "(EXISTS ( SELECT 1\n   FROM user_profiles user_profiles_1\n  WHERE ((user_profiles_1.id = auth.uid()) AND (user_profiles_1.role = 'admin'::text))))",
    "check_expression": "true"
  },
  {
    "tablename": "user_profiles",
    "policyname": "Users can insert own profile",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "INSERT",
    "using_expression": null,
    "check_expression": "(auth.uid() = id)"
  },
  {
    "tablename": "user_profiles",
    "policyname": "Users can read own profile",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "SELECT",
    "using_expression": "(auth.uid() = id)",
    "check_expression": null
  },
  {
    "tablename": "user_profiles",
    "policyname": "Users can update own profile",
    "permissive": "PERMISSIVE",
    "roles": "{public}",
    "action": "UPDATE",
    "using_expression": "(auth.uid() = id)",
    "check_expression": "((auth.uid() = id) AND (role = ( SELECT user_profiles_1.role\n   FROM user_profiles user_profiles_1\n  WHERE (user_profiles_1.id = auth.uid()))))"
  }
]